# =============================================
# ูุนุงูุฌ ุณุฌูุงุช ุงูุจุตูุงุช - ุงููุณุฎุฉ ุงููุงููุฉ
# ุงูุฅุตุฏุงุฑ 1.0
# ูุนูู ุจุฏูู ุฅูุชุฑูุช
# =============================================

import pandas as pd
import numpy as np
from datetime import datetime, timedelta
import os
import json
import tkinter as tk
from tkinter import ttk, filedialog, messagebox, scrolledtext
from tkinter.font import Font
import threading
from fpdf import FPDF
import arabic_reshaper
from bidi.algorithm import get_display
import sys

# =============================================
# ุงููุฆุฉ ุงูุฑุฆูุณูุฉ ููุนุงูุฌุฉ ุงูุจูุงูุงุช
# =============================================

class ูุนุงูุฌ_ุงูุจุตูุงุช:
    def __init__(self):
        self.ุงูุจูุงูุงุช = None
        self.ูุชุงุฆุฌ_ุงูููุธููู = {}
        
    def ูุฑุงุกุฉ_ุงูููู(self, ูุณุงุฑ_ุงูููู, ููุทูุฉ_ุงููุต=None):
        """ูุฑุงุกุฉ ููู Excel ููุนุงูุฌุฉ ุงูุจูุงูุงุช"""
        try:
            if ููุทูุฉ_ุงููุต:
                ููุทูุฉ_ุงููุต.insert(tk.END, "ุฌุงุฑู ูุฑุงุกุฉ ุงูููู...\n")
                ููุทูุฉ_ุงููุต.update()
            
            # ูุฑุงุกุฉ ููู Excel
            ููู_ุงูุณู = pd.ExcelFile(ูุณุงุฑ_ุงูููู)
            ุฌููุน_ุงูุจูุงูุงุช = []
            
            for ุงุณู_ุงููุฑูุฉ in ููู_ุงูุณู.sheet_names:
                try:
                    df = pd.read_excel(ูุณุงุฑ_ุงูููู, sheet_name=ุงุณู_ุงููุฑูุฉ, header=None)
                    
                    # ุงูุจุญุซ ุนู ุจุฏุงูุฉ ุงูุจูุงูุงุช
                    for i in range(min(10, len(df))):
                        if any('ุฑูู ุงูููุธู' in str(cell) for cell in df.iloc[i].values):
                            header_row = i
                            df = pd.read_excel(ูุณุงุฑ_ุงูููู, sheet_name=ุงุณู_ุงููุฑูุฉ, header=header_row)
                            ุฌููุน_ุงูุจูุงูุงุช.append(df)
                            break
                except:
                    continue
            
            if ุฌููุน_ุงูุจูุงูุงุช:
                self.ุงูุจูุงูุงุช = pd.concat(ุฌููุน_ุงูุจูุงูุงุช, ignore_index=True)
                # ุชูุญูุฏ ุฃุณูุงุก ุงูุฃุนูุฏุฉ
                ุฃุนูุฏุฉ_ูุญุฏุฏุฉ = {
                    'ุฑูู ุงูููุธู': ['ุฑูู ุงูููุธู', 'Employee ID', 'ID'],
                    'ุงูุฅุณู ุงูุฃูู': ['ุงูุฅุณู ุงูุฃูู', 'Employee Name', 'Name', 'ุงูุฅุณู'],
                    'ุงูุชุงุฑูุฎ': ['ุงูุชุงุฑูุฎ', 'Date'],
                    'ุงูููุช': ['ุงูููุช', 'Time'],
                    'ุญุงูุฉ ุงูุจุตูุฉ': ['ุญุงูุฉ ุงูุจุตูุฉ', 'Status', 'ููุน ุงูุจุตูุฉ']
                }
                
                for ุนููุฏ_ููุงุฆู, ุฃุณูุงุก_ูุญุชููุฉ in ุฃุนูุฏุฉ_ูุญุฏุฏุฉ.items():
                    for ุงุณู in ุฃุณูุงุก_ูุญุชููุฉ:
                        if ุงุณู in self.ุงูุจูุงูุงุช.columns:
                            self.ุงูุจูุงูุงุช.rename(columns={ุงุณู: ุนููุฏ_ููุงุฆู}, inplace=True)
                            break
                
                if ููุทูุฉ_ุงููุต:
                    ููุทูุฉ_ุงููุต.insert(tk.END, f"โ ุชู ุชุญููู {len(self.ุงูุจูุงูุงุช)} ุณุฌู ุจุตูุฉ\n")
                    ููุทูุฉ_ุงููุต.insert(tk.END, f"โ ุนุฏุฏ ุงูููุธููู: {len(self.ุงูุจูุงูุงุช['ุฑูู ุงูููุธู'].unique())}\n")
                return True
            else:
                if ููุทูุฉ_ุงููุต:
                    ููุทูุฉ_ุงููุต.insert(tk.END, "โ ูู ูุชู ุงูุนุซูุฑ ุนูู ุจูุงูุงุช ุตุญูุญุฉ\n")
                return False
                
        except Exception as e:
            if ููุทูุฉ_ุงููุต:
                ููุทูุฉ_ุงููุต.insert(tk.END, f"โ ุฎุทุฃ ูู ูุฑุงุกุฉ ุงูููู: {str(e)}\n")
            return False
    
    def ูุนุงูุฌุฉ_ุฌููุน_ุงูููุธููู(self, ููุทูุฉ_ุงููุต=None):
        """ูุนุงูุฌุฉ ุจูุงูุงุช ุฌููุน ุงูููุธููู"""
        try:
            if ููุทูุฉ_ุงููุต:
                ููุทูุฉ_ุงููุต.insert(tk.END, "ุฌุงุฑู ูุนุงูุฌุฉ ุงูุจูุงูุงุช...\n")
                ููุทูุฉ_ุงููุต.update()
            
            self.ูุชุงุฆุฌ_ุงูููุธููู = {}
            ููุธููู_ููุชูููู = 0
            
            for ุฑูู_ุงูููุธู in self.ุงูุจูุงูุงุช['ุฑูู ุงูููุธู'].unique():
                try:
                    # ุงูุญุตูู ุนูู ุงุณู ุงูููุธู
                    ุจูุงูุงุช_ุงูููุธู = self.ุงูุจูุงูุงุช[self.ุงูุจูุงูุงุช['ุฑูู ุงูููุธู'] == ุฑูู_ุงูููุธู]
                    ุงุณู_ุงูููุธู = ุจูุงูุงุช_ุงูููุธู['ุงูุฅุณู ุงูุฃูู'].iloc[0] if 'ุงูุฅุณู ุงูุฃูู' in ุจูุงูุงุช_ุงูููุธู.columns else f"ููุธู {ุฑูู_ุงูููุธู}"
                    
                    # ูุนุงูุฌุฉ ุจูุงูุงุช ุงูููุธู
                    ูุชูุฌุฉ = self.ูุนุงูุฌุฉ_ุจูุงูุงุช_ุงูููุธู(ุฑูู_ุงูููุธู, ุงุณู_ุงูููุธู)
                    
                    if not ูุชูุฌุฉ.empty:
                        self.ูุชุงุฆุฌ_ุงูููุธููู[ุฑูู_ุงูููุธู] = {
                            'ุงูุงุณู': ุงุณู_ุงูููุธู,
                            'ุงูุจูุงูุงุช': ูุชูุฌุฉ
                        }
                        ููุธููู_ููุชูููู += 1
                        
                        if ููุทูุฉ_ุงููุต and ููุธููู_ููุชูููู % 10 == 0:
                            ููุทูุฉ_ุงููุต.insert(tk.END, f"โ ุชู ูุนุงูุฌุฉ {ููุธููู_ููุชูููู} ููุธู\n")
                            ููุทูุฉ_ุงููุต.update()
                            
                except Exception as e:
                    continue
            
            if ููุทูุฉ_ุงููุต:
                ููุทูุฉ_ุงููุต.insert(tk.END, f"\nโ ุงูุชููุช ุงููุนุงูุฌุฉ\n")
                ููุทูุฉ_ุงููุต.insert(tk.END, f"โ ุนุฏุฏ ุงูููุธููู ุงููุนุงูุฌูู: {ููุธููู_ููุชูููู}\n")
            
            return True
            
        except Exception as e:
            if ููุทูุฉ_ุงููุต:
                ููุทูุฉ_ุงููุต.insert(tk.END, f"โ ุฎุทุฃ ูู ุงููุนุงูุฌุฉ: {str(e)}\n")
            return False
    
    def ูุนุงูุฌุฉ_ุจูุงูุงุช_ุงูููุธู(self, ุฑูู_ุงูููุธู, ุงุณู_ุงูููุธู):
        """ูุนุงูุฌุฉ ุจูุงูุงุช ููุธู ูุงุญุฏ"""
        try:
            ุจูุงูุงุช_ุงูููุธู = self.ุงูุจูุงูุงุช[self.ุงูุจูุงูุงุช['ุฑูู ุงูููุธู'] == ุฑูู_ุงูููุธู].copy()
            
            # ุชุญููู ุงูุชูุงุฑูุฎ ูุงูุฃููุงุช
            ุจูุงูุงุช_ุงูููุธู['ุงูุชุงุฑูุฎ'] = pd.to_datetime(ุจูุงูุงุช_ุงูููุธู['ุงูุชุงุฑูุฎ'], errors='coerce')
            ุจูุงูุงุช_ุงูููุธู['ุงูููุช'] = pd.to_datetime(ุจูุงูุงุช_ุงูููุธู['ุงูููุช'], format='%H:%M', errors='coerce').dt.time
            
            # ุญุฐู ุงูููู ุงููุงุฑุบุฉ ูุชุฑุชูุจ ุงูุจูุงูุงุช
            ุจูุงูุงุช_ุงูููุธู = ุจูุงูุงุช_ุงูููุธู.dropna(subset=['ุงูุชุงุฑูุฎ', 'ุงูููุช'])
            ุจูุงูุงุช_ุงูููุธู = ุจูุงูุงุช_ุงูููุธู.sort_values(['ุงูุชุงุฑูุฎ', 'ุงูููุช'])
            
            ูุชุงุฆุฌ = []
            ุชูุงุฑูุฎ_ูุนุงูุฌุฉ = set()
            
            for ุชุงุฑูุฎ in sorted(ุจูุงูุงุช_ุงูููุธู['ุงูุชุงุฑูุฎ'].dt.date.unique()):
                ุจูุงูุงุช_ุงูููู = ุจูุงูุงุช_ุงูููุธู[ุจูุงูุงุช_ุงูููุธู['ุงูุชุงุฑูุฎ'].dt.date == ุชุงุฑูุฎ]
                
                if len(ุจูุงูุงุช_ุงูููู) == 0:
                    continue
                
                # ุชุญุฏูุฏ ุงูุฏุฎูู ูุงูุงูุตุฑุงู
                ุฏุฎูู_ุจูุงูุงุช = ุจูุงูุงุช_ุงูููู[ุจูุงูุงุช_ุงูููู['ุญุงูุฉ ุงูุจุตูุฉ'].str.contains('ุฏุฎูู|ุชุณุฌูู ุงูุฏุฎูู|ุงูุฏุฎูู|Check in', case=False, na=False)]
                ุงูุตุฑุงู_ุจูุงูุงุช = ุจูุงูุงุช_ุงูููู[ุจูุงูุงุช_ุงูููู['ุญุงูุฉ ุงูุจุตูุฉ'].str.contains('ุฎุฑูุฌ|ุชุณุฌูู ุงูุฎุฑูุฌ|ุงูุฎุฑูุฌ|Check out', case=False, na=False)]
                
                ุฏุฎูู = ุฏุฎูู_ุจูุงูุงุช.iloc[0]['ุงูููุช'] if not ุฏุฎูู_ุจูุงูุงุช.empty else None
                ุงูุตุฑุงู = ุงูุตุฑุงู_ุจูุงูุงุช.iloc[-1]['ุงูููุช'] if not ุงูุตุฑุงู_ุจูุงูุงุช.empty else None
                
                # ุฅุฐุง ูู ููู ููุงู ุงูุตุฑุงูุ ูุจุญุซ ูู ุงูููู ุงูุชุงูู
                if ุฏุฎูู and not ุงูุตุฑุงู:
                    ุชุงุฑูุฎ_ุงูุชุงูู = ุชุงุฑูุฎ + timedelta(days=1)
                    ุจูุงูุงุช_ุงูุบุฏ = ุจูุงูุงุช_ุงูููุธู[ุจูุงูุงุช_ุงูููุธู['ุงูุชุงุฑูุฎ'].dt.date == ุชุงุฑูุฎ_ุงูุชุงูู]
                    if not ุจูุงูุงุช_ุงูุบุฏ.empty:
                        ุงูุตุฑุงู = ุจูุงูุงุช_ุงูุบุฏ.iloc[0]['ุงูููุช']
                
                # ุญุณุงุจ ุณุงุนุงุช ุงูุนูู
                ุณุงุนุงุช_ุงูุนูู = self.ุญุณุงุจ_ุงูุณุงุนุงุช(ุฏุฎูู, ุงูุตุฑุงู)
                
                # ูุดู ุงูุจุตูุงุช ุงูุฒุงุฆุฏุฉ
                ููุงุญุธุงุช = ""
                if len(ุจูุงูุงุช_ุงูููู) > 2:
                    ููุงุญุธุงุช = f"{len(ุจูุงูุงุช_ุงูููู)} ุจุตูุงุช"
                elif len(ุจูุงูุงุช_ุงูููู) == 1:
                    ููุงุญุธุงุช = "ุจุตูุฉ ูุงุญุฏุฉ"
                
                ูุชุงุฆุฌ.append({
                    'ุงูุชุงุฑูุฎ': ุชุงุฑูุฎ.strftime('%Y-%m-%d'),
                    'ุงูููู': self.ุงูุญุตูู_ุนูู_ุงุณู_ุงูููู(ุชุงุฑูุฎ),
                    'ุงูุญุถูุฑ ูู ุงูุฌุฏูู': '08:00',
                    'ุงูุงูุตุฑุงู ูู ุงูุฌุฏูู': '17:00',
                    'ุฅุฌุงุฒุฉ': '',
                    'ุจุตูุฉ ุงูุญุถูุฑ': ุฏุฎูู.strftime('%H:%M') if ุฏุฎูู else '',
                    'ุจุตูุฉ ุงูุงูุตุฑุงู': ุงูุตุฑุงู.strftime('%H:%M') if ุงูุตุฑุงู else '',
                    'ุณุงุนุงุช ุงูุนูู': ุณุงุนุงุช_ุงูุนูู,
                    'ุณุงุนุงุช ุงูุชุงุฎุฑ': self.ุญุณุงุจ_ุงูุชุงุฎุฑ('08:00', ุฏุฎูู.strftime('%H:%M') if ุฏุฎูู else ''),
                    'ุณุงุนุงุช ุงูุฎุฑูุฌ ุงููุจูุฑ': self.ุญุณุงุจ_ุฎุฑูุฌ_ูุจูุฑ('17:00', ุงูุตุฑุงู.strftime('%H:%M') if ุงูุตุฑุงู else ''),
                    'ุฃูุงู ุงูุบูุงุจ': 'ูุนู' if not ุฏุฎูู and not ุงูุตุฑุงู else '',
                    'ุงูุฅุฌุงุฒุงุช': '',
                    'ููุงุญุธุงุช': ููุงุญุธุงุช
                })
                
                ุชูุงุฑูุฎ_ูุนุงูุฌุฉ.add(ุชุงุฑูุฎ)
            
            return pd.DataFrame(ูุชุงุฆุฌ)
            
        except Exception as e:
            print(f"ุฎุทุฃ ูู ูุนุงูุฌุฉ ุงูููุธู {ุฑูู_ุงูููุธู}: {e}")
            return pd.DataFrame()
    
    def ุญุณุงุจ_ุงูุณุงุนุงุช(self, ุฏุฎูู, ุงูุตุฑุงู):
        """ุญุณุงุจ ุณุงุนุงุช ุงูุนูู"""
        if not ุฏุฎูู or not ุงูุตุฑุงู:
            return "0:00"
        
        try:
            # ุชุญููู ุงูููุช ุฅูู ูุงุฆู datetime
            if isinstance(ุฏุฎูู, str):
                ุฏุฎูู_ููุช = datetime.strptime(ุฏุฎูู, '%H:%M')
            else:
                ุฏุฎูู_ููุช = datetime.combine(datetime.today(), ุฏุฎูู)
            
            if isinstance(ุงูุตุฑุงู, str):
                ุงูุตุฑุงู_ููุช = datetime.strptime(ุงูุตุฑุงู, '%H:%M')
            else:
                ุงูุตุฑุงู_ููุช = datetime.combine(datetime.today(), ุงูุตุฑุงู)
            
            # ุฅุฐุง ูุงู ุงูุงูุตุฑุงู ูุจู ุงูุฏุฎูู (ุจุนุฏ ููุชุตู ุงูููู)
            if ุงูุตุฑุงู_ููุช < ุฏุฎูู_ููุช:
                ุงูุตุฑุงู_ููุช += timedelta(days=1)
            
            # ุญุณุงุจ ุงููุฑู
            ุงููุฑู = ุงูุตุฑุงู_ููุช - ุฏุฎูู_ููุช
            ุณุงุนุงุช = ุงููุฑู.seconds // 3600
            ุฏูุงุฆู = (ุงููุฑู.seconds % 3600) // 60
            
            return f"{ุณุงุนุงุช}:{ุฏูุงุฆู:02d}"
        except:
            return "0:00"
    
    def ุญุณุงุจ_ุงูุชุงุฎุฑ(self, ููุช_ููุชุฑุถ, ููุช_ูุนูู):
        """ุญุณุงุจ ุณุงุนุงุช ุงูุชุฃุฎุฑ"""
        if not ููุช_ูุนูู:
            return ""
        
        try:
            ููุชุฑุถ = datetime.strptime(ููุช_ููุชุฑุถ, '%H:%M')
            ูุนูู = datetime.strptime(ููุช_ูุนูู, '%H:%M')
            
            if ูุนูู > ููุชุฑุถ:
                ุงููุฑู = ูุนูู - ููุชุฑุถ
                ุฏูุงุฆู = ุงููุฑู.seconds // 60
                return f"{ุฏูุงุฆู} ุฏูููุฉ"
            return ""
        except:
            return ""
    
    def ุญุณุงุจ_ุฎุฑูุฌ_ูุจูุฑ(self, ููุช_ููุชุฑุถ, ููุช_ูุนูู):
        """ุญุณุงุจ ุณุงุนุงุช ุงูุฎุฑูุฌ ุงููุจูุฑ"""
        if not ููุช_ูุนูู:
            return ""
        
        try:
            ููุชุฑุถ = datetime.strptime(ููุช_ููุชุฑุถ, '%H:%M')
            ูุนูู = datetime.strptime(ููุช_ูุนูู, '%H:%M')
            
            if ูุนูู < ููุชุฑุถ:
                ุงููุฑู = ููุชุฑุถ - ูุนูู
                ุฏูุงุฆู = ุงููุฑู.seconds // 60
                return f"{ุฏูุงุฆู} ุฏูููุฉ"
            return ""
        except:
            return ""
    
    def ุงูุญุตูู_ุนูู_ุงุณู_ุงูููู(self, ุชุงุฑูุฎ):
        """ุงูุญุตูู ุนูู ุงุณู ุงูููู"""
        ุฃูุงู_ุงูุฃุณุจูุน = ['ุงูุงุซููู', 'ุงูุซูุงุซุงุก', 'ุงูุฃุฑุจุนุงุก', 'ุงูุฎููุณ', 'ุงูุฌูุนุฉ', 'ุงูุณุจุช', 'ุงูุฃุญุฏ']
        return ุฃูุงู_ุงูุฃุณุจูุน[ุชุงุฑูุฎ.weekday()]
    
    def ุชุตุฏูุฑ_excel(self, ูุณุงุฑ_ุงูุญูุธ, ููุทูุฉ_ุงููุต=None):
        """ุชุตุฏูุฑ ุงูุจูุงูุงุช ุฅูู ููู Excel"""
        try:
            if ููุทูุฉ_ุงููุต:
                ููุทูุฉ_ุงููุต.insert(tk.END, "ุฌุงุฑู ุชุตุฏูุฑ Excel...\n")
                ููุทูุฉ_ุงููุต.update()
            
            with pd.ExcelWriter(ูุณุงุฑ_ุงูุญูุธ, engine='openpyxl') as ูุงุชุจ:
                # ุฅูุดุงุก ุตูุญุฉ ุงูููุฑุณ
                ููุฑุณ_ุจูุงูุงุช = []
                for ุฑูู, ุจูุงูุงุช in self.ูุชุงุฆุฌ_ุงูููุธููู.items():
                    ููุฑุณ_ุจูุงูุงุช.append({
                        'ุฑูู ุงูููุธู': ุฑูู,
                        'ุงุณู ุงูููุธู': ุจูุงูุงุช['ุงูุงุณู'],
                        'ุนุฏุฏ ุงูุฃูุงู': len(ุจูุงูุงุช['ุงูุจูุงูุงุช'])
                    })
                
                if ููุฑุณ_ุจูุงูุงุช:
                    ููุฑุณ_df = pd.DataFrame(ููุฑุณ_ุจูุงูุงุช)
                    ููุฑุณ_df.to_excel(ูุงุชุจ, sheet_name='ููุฑุณ ุงูููุธููู', index=False)
                
                # ุฅูุดุงุก ุตูุญุฉ ููู ููุธู
                for ุฑูู, ุจูุงูุงุช in self.ูุชุงุฆุฌ_ุงูููุธููู.items():
                    ุงุณู_ุงูุตูุญุฉ = f"{ุฑูู}_{ุจูุงูุงุช['ุงูุงุณู'][:20]}"
                    ุจูุงูุงุช['ุงูุจูุงูุงุช'].to_excel(ูุงุชุจ, sheet_name=ุงุณู_ุงูุตูุญุฉ, index=False)
            
            if ููุทูุฉ_ุงููุต:
                ููุทูุฉ_ุงููุต.insert(tk.END, f"โ ุชู ุชุตุฏูุฑ Excel: {ูุณุงุฑ_ุงูุญูุธ}\n")
            
            return True
            
        except Exception as e:
            if ููุทูุฉ_ุงููุต:
                ููุทูุฉ_ุงููุต.insert(tk.END, f"โ ุฎุทุฃ ูู ุชุตุฏูุฑ Excel: {str(e)}\n")
            return False
    
    def ุชุตุฏูุฑ_pdf(self, ูุณุงุฑ_ุงูุญูุธ, ููุทูุฉ_ุงููุต=None):
        """ุชุตุฏูุฑ ุงูุจูุงูุงุช ุฅูู ููู PDF"""
        try:
            if ููุทูุฉ_ุงููุต:
                ููุทูุฉ_ุงููุต.insert(tk.END, "ุฌุงุฑู ุชุตุฏูุฑ PDF...\n")
                ููุทูุฉ_ุงููุต.update()
            
            pdf = FPDF()
            pdf.set_auto_page_break(auto=True, margin=15)
            pdf.add_page()
            
            # ุฅุถุงูุฉ ุฑุฃุณ ุงูุตูุญุฉ
            pdf.set_font('Arial', 'B', 16)
            pdf.cell(0, 10, 'ุชูุฑูุฑ ุญุถูุฑ ูุงูุตุฑุงู ุงูููุธููู', 0, 1, 'C')
            pdf.ln(10)
            
            # ุฅุถุงูุฉ ุชุงุฑูุฎ ุงูุชูุฑูุฑ
            pdf.set_font('Arial', '', 12)
            pdf.cell(0, 10, f"ุชุงุฑูุฎ ุงูุชูุฑูุฑ: {datetime.now().strftime('%Y-%m-%d %H:%M')}", 0, 1, 'R')
            pdf.ln(10)
            
            # ุฅุถุงูุฉ ุจูุงูุงุช ูู ููุธู
            pdf.set_font('Arial', 'B', 12)
            
            for ุฑูู, ุจูุงูุงุช in list(self.ูุชุงุฆุฌ_ุงูููุธููู.items())[:50]:  # ุงูุญุฏ ูู 50 ููุธู ูุญุฏ ุฃูุตู
                # ุนููุงู ุงูููุธู
                pdf.cell(0, 10, f"ุงูููุธู: {ุจูุงูุงุช['ุงูุงุณู']} (ุฑูู: {ุฑูู})", 0, 1, 'R')
                pdf.set_font('Arial', '', 10)
                
                # ุฅูุดุงุก ุฌุฏูู
                if len(ุจูุงูุงุช['ุงูุจูุงูุงุช']) > 0:
                    # ุฑุฃุณ ุงูุฌุฏูู
                    pdf.cell(40, 10, 'ุงูุชุงุฑูุฎ', 1)
                    pdf.cell(30, 10, 'ุงูุญุถูุฑ', 1)
                    pdf.cell(30, 10, 'ุงูุงูุตุฑุงู', 1)
                    pdf.cell(30, 10, 'ุงูุณุงุนุงุช', 1)
                    pdf.cell(40, 10, 'ููุงุญุธุงุช', 1)
                    pdf.ln()
                    
                    # ุจูุงูุงุช ุงูุฌุฏูู
                    for _, ุตู in ุจูุงูุงุช['ุงูุจูุงูุงุช'].iterrows():
                        pdf.cell(40, 10, str(ุตู['ุงูุชุงุฑูุฎ']), 1)
                        pdf.cell(30, 10, str(ุตู['ุจุตูุฉ ุงูุญุถูุฑ']), 1)
                        pdf.cell(30, 10, str(ุตู['ุจุตูุฉ ุงูุงูุตุฑุงู']), 1)
                        pdf.cell(30, 10, str(ุตู['ุณุงุนุงุช ุงูุนูู']), 1)
                        pdf.cell(40, 10, str(ุตู['ููุงุญุธุงุช']), 1)
                        pdf.ln()
                
                pdf.ln(15)
                pdf.set_font('Arial', 'B', 12)
            
            pdf.output(ูุณุงุฑ_ุงูุญูุธ)
            
            if ููุทูุฉ_ุงููุต:
                ููุทูุฉ_ุงููุต.insert(tk.END, f"โ ุชู ุชุตุฏูุฑ PDF: {ูุณุงุฑ_ุงูุญูุธ}\n")
            
            return True
            
        except Exception as e:
            if ููุทูุฉ_ุงููุต:
                ููุทูุฉ_ุงููุต.insert(tk.END, f"โ ุฎุทุฃ ูู ุชุตุฏูุฑ PDF: {str(e)}\n")
            return False

# =============================================
# ูุงุฌูุฉ ุงููุณุชุฎุฏู ุงูุฑุณูููุฉ
# =============================================

class ูุงุฌูุฉ_ุงููุนุงูุฌ:
    def __init__(self):
        self.ูุงูุฐุฉ = tk.Tk()
        self.ูุงูุฐุฉ.title("ูุนุงูุฌ ุณุฌูุงุช ุงูุจุตูุงุช")
        self.ูุงูุฐุฉ.geometry("800x600")
        self.ูุงูุฐุฉ.configure(bg='#f0f0f0')
        
        self.ูุนุงูุฌ = ูุนุงูุฌ_ุงูุจุตูุงุช()
        self.ูุณุงุฑ_ุงูููู = None
        
        self.ุฅูุดุงุก_ุงููุงุฌูุฉ()
    
    def ุฅูุดุงุก_ุงููุงุฌูุฉ(self):
        """ุฅูุดุงุก ูุงุฌูุฉ ุงููุณุชุฎุฏู"""
        # ุฅุทุงุฑ ุงูุนููุงู
        ุฅุทุงุฑ_ุงูุนููุงู = tk.Frame(self.ูุงูุฐุฉ, bg='#2c3e50', height=80)
        ุฅุทุงุฑ_ุงูุนููุงู.pack(fill=tk.X)
        ุฅุทุงุฑ_ุงูุนููุงู.pack_propagate(False)
        
        ุนููุงู = tk.Label(ุฅุทุงุฑ_ุงูุนููุงู, text="ูุนุงูุฌ ุณุฌูุงุช ุงูุจุตูุงุช", 
                        font=('Arial', 24, 'bold'), fg='white', bg='#2c3e50')
        ุนููุงู.pack(pady=20)
        
        # ุฅุทุงุฑ ุงูุชุญูู
        ุฅุทุงุฑ_ุงูุชุญูู = tk.Frame(self.ูุงูุฐุฉ, bg='#f0f0f0', padx=20, pady=20)
        ุฅุทุงุฑ_ุงูุชุญูู.pack(fill=tk.X)
        
        # ุฒุฑ ุงุฎุชูุงุฑ ุงูููู
        ุฒุฑ_ุงูููู = tk.Button(ุฅุทุงุฑ_ุงูุชุญูู, text="๐ ุงุฎุชุฑ ููู Excel", 
                            font=('Arial', 12), bg='#3498db', fg='white',
                            command=self.ุงุฎุชูุงุฑ_ููู, height=2, width=20)
        ุฒุฑ_ุงูููู.pack(side=tk.LEFT, padx=10)
        
        # ุฒุฑ ุงููุนุงูุฌุฉ
        ุฒุฑ_ุงููุนุงูุฌุฉ = tk.Button(ุฅุทุงุฑ_ุงูุชุญูู, text="โ๏ธ ูุนุงูุฌุฉ ุงูุจูุงูุงุช", 
                               font=('Arial', 12), bg='#2ecc71', fg='white',
                               command=self.ูุนุงูุฌุฉ_ุงูุจูุงูุงุช, height=2, width=20)
        ุฒุฑ_ุงููุนุงูุฌุฉ.pack(side=tk.LEFT, padx=10)
        
        # ุฒุฑ ุงูุชุตุฏูุฑ Excel
        ุฒุฑ_excel = tk.Button(ุฅุทุงุฑ_ุงูุชุญูู, text="๐ ุชุตุฏูุฑ Excel", 
                           font=('Arial', 12), bg='#e74c3c', fg='white',
                           command=lambda: self.ุชุตุฏูุฑ('excel'), height=2, width=20)
        ุฒุฑ_excel.pack(side=tk.LEFT, padx=10)
        
        # ุฒุฑ ุงูุชุตุฏูุฑ PDF
        ุฒุฑ_pdf = tk.Button(ุฅุทุงุฑ_ุงูุชุญูู, text="๐ ุชุตุฏูุฑ PDF", 
                          font=('Arial', 12), bg='#9b59b6', fg='white',
                          command=lambda: self.ุชุตุฏูุฑ('pdf'), height=2, width=20)
        ุฒุฑ_pdf.pack(side=tk.LEFT, padx=10)
        
        # ููุทูุฉ ุงููุต ููุฅุฎุฑุงุฌ
        ุฅุทุงุฑ_ุงููุต = tk.Frame(self.ูุงูุฐุฉ, bg='white')
        ุฅุทุงุฑ_ุงููุต.pack(fill=tk.BOTH, expand=True, padx=20, pady=(0, 20))
        
        self.ููุทูุฉ_ุงููุต = scrolledtext.ScrolledText(ุฅุทุงุฑ_ุงููุต, font=('Arial', 10), 
                                                    bg='white', fg='#2c3e50')
        self.ููุทูุฉ_ุงููุต.pack(fill=tk.BOTH, expand=True)
        
        # ุฑุณุงูุฉ ุชุฑุญูุจ
        self.ููุทูุฉ_ุงููุต.insert(tk.END, "ูุฑุญุจูุง ุจูู ูู ูุนุงูุฌ ุณุฌูุงุช ุงูุจุตูุงุช\n")
        self.ููุทูุฉ_ุงููุต.insert(tk.END, "=" * 50 + "\n")
        self.ููุทูุฉ_ุงููุต.insert(tk.END, "ุฎุทูุงุช ุงูุงุณุชุฎุฏุงู:\n")
        self.ููุทูุฉ_ุงููุต.insert(tk.END, "1. ุงููุฑ ุนูู 'ุงุฎุชุฑ ููู Excel' ูุชุญููู ุงูุจูุงูุงุช\n")
        self.ููุทูุฉ_ุงููุต.insert(tk.END, "2. ุงููุฑ ุนูู 'ูุนุงูุฌุฉ ุงูุจูุงูุงุช' ูุชุญููู ุงูุจุตูุงุช\n")
        self.ููุทูุฉ_ุงููุต.insert(tk.END, "3. ุงุฎุชุฑ ููุน ุงูุชุตุฏูุฑ ุงููุทููุจ\n")
        self.ููุทูุฉ_ุงููุต.insert(tk.END, "=" * 50 + "\n\n")
    
    def ุงุฎุชูุงุฑ_ููู(self):
        """ุงุฎุชูุงุฑ ููู Excel"""
        ูุณุงุฑ = filedialog.askopenfilename(
            title="ุงุฎุชุฑ ููู Excel",
            filetypes=[("Excel files", "*.xlsx *.xls"), ("All files", "*.*")]
        )
        
        if ูุณุงุฑ:
            self.ูุณุงุฑ_ุงูููู = ูุณุงุฑ
            self.ููุทูุฉ_ุงููุต.insert(tk.END, f"โ ุชู ุงุฎุชูุงุฑ ุงูููู: {os.path.basename(ูุณุงุฑ)}\n")
            self.ููุทูุฉ_ุงููุต.see(tk.END)
    
    def ูุนุงูุฌุฉ_ุงูุจูุงูุงุช(self):
        """ูุนุงูุฌุฉ ุงูุจูุงูุงุช ูู ุฎูุท ูููุตู"""
        if not self.ูุณุงุฑ_ุงูููู:
            messagebox.showerror("ุฎุทุฃ", "ุงูุฑุฌุงุก ุงุฎุชูุงุฑ ููู ุฃููุงู")
            return
        
        # ุชุนุทูู ุงูุฃุฒุฑุงุฑ ุฃุซูุงุก ุงููุนุงูุฌุฉ
        self.ูุงูุฐุฉ.configure(cursor='watch')
        
        # ุชุดุบูู ุงููุนุงูุฌุฉ ูู ุฎูุท ูููุตู
        ุฎูุท = threading.Thread(target=self.ุชุดุบูู_ุงููุนุงูุฌุฉ)
        ุฎูุท.start()
    
    def ุชุดุบูู_ุงููุนุงูุฌุฉ(self):
        """ุชุดุบูู ุนูููุฉ ุงููุนุงูุฌุฉ"""
        try:
            self.ููุทูุฉ_ุงููุต.delete(1.0, tk.END)
            self.ููุทูุฉ_ุงููุต.insert(tk.END, "ุฌุงุฑู ูุนุงูุฌุฉ ุงูุจูุงูุงุช...\n")
            
            # ูุฑุงุกุฉ ุงูููู
            if not self.ูุนุงูุฌ.ูุฑุงุกุฉ_ุงูููู(self.ูุณุงุฑ_ุงูููู, self.ููุทูุฉ_ุงููุต):
                self.ูุงูุฐุฉ.configure(cursor='')
                return
            
            # ูุนุงูุฌุฉ ุงูุจูุงูุงุช
            if not self.ูุนุงูุฌ.ูุนุงูุฌุฉ_ุฌููุน_ุงูููุธููู(self.ููุทูุฉ_ุงููุต):
                self.ูุงูุฐุฉ.configure(cursor='')
                return
            
            self.ููุทูุฉ_ุงููุต.insert(tk.END, "\nโ ุฌุงูุฒ ููุชุตุฏูุฑ\n")
            
        except Exception as e:
            self.ููุทูุฉ_ุงููุต.insert(tk.END, f"โ ุฎุทุฃ: {str(e)}\n")
        
        finally:
            self.ูุงูุฐุฉ.configure(cursor='')
            self.ูุงูุฐุฉ.update()
    
    def ุชุตุฏูุฑ(self, ููุน):
        """ุชุตุฏูุฑ ุงูุจูุงูุงุช"""
        if not self.ูุนุงูุฌ.ูุชุงุฆุฌ_ุงูููุธููู:
            messagebox.showerror("ุฎุทุฃ", "ุงูุฑุฌุงุก ูุนุงูุฌุฉ ุงูุจูุงูุงุช ุฃููุงู")
            return
        
        if ููุน == 'excel':
            ููู = filedialog.asksaveasfilename(
                title="ุญูุธ ููู Excel",
                defaultextension=".xlsx",
                filetypes=[("Excel files", "*.xlsx"), ("All files", "*.*")]
            )
            if ููู:
                if self.ูุนุงูุฌ.ุชุตุฏูุฑ_excel(ููู, self.ููุทูุฉ_ุงููุต):
                    messagebox.showinfo("ูุฌุงุญ", f"ุชู ุชุตุฏูุฑ Excel ุจูุฌุงุญ\n{ููู}")
        
        elif ููุน == 'pdf':
            ููู = filedialog.asksaveasfilename(
                title="ุญูุธ ููู PDF",
                defaultextension=".pdf",
                filetypes=[("PDF files", "*.pdf"), ("All files", "*.*")]
            )
            if ููู:
                if self.ูุนุงูุฌ.ุชุตุฏูุฑ_pdf(ููู, self.ููุทูุฉ_ุงููุต):
                    messagebox.showinfo("ูุฌุงุญ", f"ุชู ุชุตุฏูุฑ PDF ุจูุฌุงุญ\n{ููู}")
    
    def ุชุดุบูู(self):
        """ุชุดุบูู ุงููุงุฌูุฉ"""
        self.ูุงูุฐุฉ.mainloop()

# =============================================
# ุฏุงูุฉ ุงูุชุดุบูู ุงูุฑุฆูุณูุฉ
# =============================================

def main():
    """ุงูุฏุงูุฉ ุงูุฑุฆูุณูุฉ ูุชุดุบูู ุงูุจุฑูุงูุฌ"""
    try:
        # ุฅูุดุงุก ูุฌูุฏ ุงูุชุทุจูู
        if not os.path.exists('ูุฎุฑุฌุงุช'):
            os.makedirs('ูุฎุฑุฌุงุช')
        
        # ุชุดุบูู ุงููุงุฌูุฉ
        ุชุทุจูู = ูุงุฌูุฉ_ุงููุนุงูุฌ()
        ุชุทุจูู.ุชุดุบูู()
        
    except Exception as e:
        print(f"ุฎุทุฃ ูู ุชุดุบูู ุงูุจุฑูุงูุฌ: {e}")
        input("ุงุถุบุท Enter ููุฅุบูุงู...")

# =============================================
# ููุทุฉ ุงูุฏุฎูู
# =============================================

if __name__ == "__main__":
    print("=" * 50)
    print("ูุนุงูุฌ ุณุฌูุงุช ุงูุจุตูุงุช - ุงูุฅุตุฏุงุฑ 1.0")
    print("=" * 50)
    print("ุฌุงุฑู ุงูุชุดุบูู...")
    main()